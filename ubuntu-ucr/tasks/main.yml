---
- name: Get non-root user running the play.
  local_action: command whoami
  register: user_on_host
  tags:
    - execution
    - test
    - current
    - fact

- name: unitTest - Retrieved non-root user running the play.
  command: echo "{{ user_on_host }}"
  register: result
  failed_when: result.stdout == ''
  tags:
    - test
    - fact

- name: Verify if mate is installed and store the result.
  command: bash -c "apt list --installed | grep mate-desktop"
  register: mate_xsession
  tags:
    - execution
    - test
    - packages
    - desktop
    - mate
    - plymouth
    - current
    - fact

- name: unitTest - Verified mate is installed or no run sucessfully.
  command: echo "{{ mate_xsession.stderr }}"
  register: result
  failed_when: "result.stdout != '' and result.stdout != '\nWARNING: apt does not have a stable CLI interface. Use with caution in scripts.'"
  tags:
    - test
    - fact

- import_tasks: repositories/main.yml
- import_tasks: packages/main.yml
- import_tasks: system/main.yml
- import_tasks: desktop/main.yml
